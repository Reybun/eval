-- MySQL Script generated by MySQL Workbench
-- Fri Jan  4 15:50:56 2019
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering
-- -----------------------------------------------------
-- Schema evalbdd
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema evalbdd
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `evalbdd` DEFAULT CHARACTER SET utf8 ;
USE `evalbdd` ;

-- -----------------------------------------------------
-- Table `evalbdd`.`user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`user` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(16) NOT NULL,
  `email` VARCHAR(255) NULL,
  `password` VARCHAR(255) NOT NULL,
  `picture` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id`)) 
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `evalbdd`.`responsable`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`responsable` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `nom` VARCHAR(45) NOT NULL,
  `prenom` VARCHAR(45) NOT NULL,
  `numero` VARCHAR(11) NULL,
  `mail` VARCHAR(75) NULL,
  `adresse` VARCHAR(85) NULL,
  `modevie` VARCHAR(255) NULL,
  `alimentation` VARCHAR(255) NULL,
  `code_postal` INT(11) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;



-- -----------------------------------------------------
-- Table `evalbdd`.`patient`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`patient` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `prenom` VARCHAR(45) NOT NULL,
  `adresse` VARCHAR(85) NULL,
  `code_postal` INT(11) NULL,
  `mail` VARCHAR(75) NULL,
  `datebirth` DATE NULL,
  `tel` VARCHAR(11) NULL,
  `statut` ENUM('humain', 'animal') NULL,
  `responsable_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_patient_responsable1_idx` (`responsable_id` ASC),
  CONSTRAINT `fk_patient_responsable1`
    FOREIGN KEY (`responsable_id`)
    REFERENCES `evalbdd`.`responsable` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `evalbdd`.`fiche_consult`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`fiche_consult` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `resume` VARCHAR(45) NULL,
  `type` VARCHAR(255) NULL,
  `place` VARCHAR(255) NULL,
  `protocole` VARCHAR(255) NULL,
  `pathologie` VARCHAR(255) NULL,
  `resultat` VARCHAR(255) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `evalbdd`.`rdv`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`rdv` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `time` TIME NOT NULL,
  `date` DATE NOT NULL,
  `description` VARCHAR(255) NULL,
  `patient_id` INT(11) NOT NULL,
  `fiche_consult_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_rdv_patient1_idx` (`patient_id` ASC),
  INDEX `fk_rdv_fiche_consult1_idx` (`fiche_consult_id` ASC),
  CONSTRAINT `fk_rdv_patient1`
    FOREIGN KEY (`patient_id`)
    REFERENCES `evalbdd`.`patient` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_rdv_fiche_consult1`
    FOREIGN KEY (`fiche_consult_id`)
    REFERENCES `evalbdd`.`fiche_consult` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `evalbdd`.`user_has_rdv`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`user_has_rdv` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `user_id` INT(11) NOT NULL,
  `rdv_id` INT(11) NOT NULL,
  INDEX `fk_user_has_rdv_rdv1_idx` (`rdv_id` ASC),
  INDEX `fk_user_has_rdv_user_idx` (`user_id` ASC),
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_user_has_rdv_user`
    FOREIGN KEY (`user_id`)
    REFERENCES `evalbdd`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_user_has_rdv_rdv1`
    FOREIGN KEY (`rdv_id`)
    REFERENCES `evalbdd`.`rdv` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table `evalbdd`.`conge`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`conge` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `hdate` DATETIME NOT NULL,
  `user_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `evalbdd`.`horaire`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`horaire` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `jour` VARCHAR(12) NOT NULL,
  `statut` ENUM('deb', 'fin') NOT NULL,
  `heure` TIME NOT NULL,
  `user_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `evalbdd`.`specialite`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`specialite` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `nom` VARCHAR(45) NOT NULL,
  `tarif seance` INT(11) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `evalbdd`.`specialite_has_user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`specialite_has_user` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `specialite_id` INT(11) NOT NULL,
  `user_id` INT(11) NOT NULL,
  INDEX `fk_specialite_has_user_user1_idx` (`user_id` ASC),
  INDEX `fk_specialite_has_user_specialite1_idx` (`specialite_id` ASC),
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_specialite_has_user_specialite1`
    FOREIGN KEY (`specialite_id`)
    REFERENCES `evalbdd`.`specialite` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `evalbdd`.`photo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `evalbdd`.`photo` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `photo` LONGTEXT NOT NULL,
  `fiche_consult_id` INT(11) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_photo_fiche_consult1_idx` (`fiche_consult_id` ASC),
  CONSTRAINT `fk_photo_fiche_consult1`
    FOREIGN KEY (`fiche_consult_id`)
    REFERENCES `evalbdd`.`fiche_consult` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

ALTER TABLE conge
ADD CONSTRAINT `fk_conge_user1`
    FOREIGN KEY (`user_id`)
    REFERENCES user(`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION;

ALTER TABLE `horaire`
ADD CONSTRAINT `fk_horaire_user1`
    FOREIGN KEY (`user_id`)
    REFERENCES `evalbdd`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION;

ALTER TABLE `specialite_has_user` ADD CONSTRAINT `fk_specialite_has_user_user1`
    FOREIGN KEY (`user_id`)
    REFERENCES `evalbdd`.`user` (`id`)
    ON DELETE NO ACTION ON UPDATE NO ACTION;
